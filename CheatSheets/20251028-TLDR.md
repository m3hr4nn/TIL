# Complete System Architecture - TLDR

## 🏗️ System Overview

```
┌─────────────────────────────────────────────────────────────────┐
│                         USER LAYER                              │
│  Web Browser → GraphQL/REST API → Load Balancer                 │
└────────────────────┬────────────────────────────────────────────┘
                     │
┌────────────────────▼────────────────────────────────────────────┐
│                    API GATEWAY LAYER                            │
│  Kong/AWS API Gateway → Auth → Rate Limiting → Routing          │
└────────────────────┬────────────────────────────────────────────┘
                     │
┌────────────────────▼────────────────────────────────────────────┐
│                  MICROSERVICES LAYER                            │
│  ┌──────────┐  ┌──────────┐  ┌─────────┐  ┌──────────┐          │
│  │ User Svc │  │Order Svc │  │Inventory│  │Warehouse │          │
│  │          │  │          │  │   Svc   │  │   Svc    │          │
│  └────┬─────┘  └────┬─────┘  └────┬────┘  └─────┬────┘          │
│       │             │             │             │               │
└───────┼─────────────┼─────────────┼─────────────┼───────────────┘
        │             │             │             │
┌───────▼─────────────▼─────────────▼─────────────▼───────────────┐
│                    MIDDLEWARE LAYER                             │
│  ┌─────────────┐  ┌──────────┐  ┌─────────┐  ┌─────────┐        │
│  │  RabbitMQ   │  │  Kafka   │  │ Redis   │  │ Service │        │
│  │  (Queue)    │  │ (Stream) │  │ (Cache) │  │  Mesh   │        │
│  └─────────────┘  └──────────┘  └─────────┘  └─────────┘        │
└────────────────────┬────────────────────────────────────────────┘
                     │
┌────────────────────▼───────────────────────────────────────────┐
│                    DATA LAYER                                  │
│  ┌────────────┐  ┌────────────┐  ┌──────────┐  ┌──────────┐    │
│  │PostgreSQL  │  │Elasticsearch│ │  Redis   │  │  Files   │    │
│  │(Primary DB)│  │  (Search)   │ │ (Cache)  │  │  (S3)    │    │
│  └────────────┘  └────────────┘  └──────────┘  └──────────┘    │ 
└────────────────────┬───────────────────────────────────────────┘
                     │
┌────────────────────▼────────────────────────────────────────────┐
│              WAREHOUSE AUTOMATION LAYER                         │
│  ┌─────────────────────┐      ┌──────────────────────┐          │
│  │   WMS (Business)    │◄────►│   WCS (Control)      │          │
│  │  - Order Processing │      │  - Conveyor Control  │          │
│  │  - Inventory Mgmt   │      │  - Sorter Management │          │
│  │  - Pick Waves       │      │  - Robot Dispatch    │          │
│  └─────────────────────┘      └───────────┬──────────┘          │
└───────────────────────────────────────────┼─────────────────────┘
                                            │
┌───────────────────────────────────────────▼─────────────────────┐
│                    PHYSICAL LAYER                               │
│  Conveyors → Sorters → AS/RS → AGV/AMR → Pick-to-Light          │
└─────────────────────────────────────────────────────────────────┘
```

## 📦 Technology Stack by Layer

### 1. Frontend & API Layer
```
┌─────────────────────────────────────────────┐
│ GraphQL                                     │
│ • Single endpoint, flexible queries         │
│ • Typed schema, no over-fetching            │
│ • Query: { user { name posts { title } } }  │
│                                             │
│ REST API                                    │
│ • GET /api/users (retrieve)                 │
│ • POST /api/users (create)                  │
│ • PUT/PATCH /api/users/123 (update)         │
│ • DELETE /api/users/123 (remove)            │
│                                             │
│ Status: 200 OK, 201 Created, 404 Not Found  │
└─────────────────────────────────────────────┘
```

### 2. Infrastructure & Orchestration
```
┌──────────────────────────────────────────────┐
│ Docker                                       │
│ • Containerization: docker build -t app .    │
│ • Run: docker run -p 8080:80 app             │
│ • Compose: docker-compose up -d              │
│                                              │
│ Kubernetes                                   │
│ • Pods: Smallest unit (containers)           │
│ • Deployments: Manage replicas               │
│ • Services: Stable networking                │
│ • kubectl get pods / apply -f deploy.yaml    │
│                                              │
│ GCP                                          │
│ • Cloud SQL: Managed PostgreSQL              │
│ • GKE: Kubernetes Engine                     │
│ • Cloud Storage: Object storage              │
└──────────────────────────────────────────────┘
```

### 3. Middleware & Integration
```
┌──────────────────────────────────────────────┐
│ Message Brokers                              │
│ • RabbitMQ: Producer → Exchange → Queue      │ 
│ • Kafka: Producer → Topic → Consumer Group   │
│ • Use: Async processing, decoupling          │
│                                              │
│ API Gateway                                  │
│ • Single entry point                         │
│ • Authentication, rate limiting              │
│ • Load balancing, routing                    │
│                                              │
│ Service Mesh (Istio)                         │
│ • Service-to-service communication           │
│ • Circuit breakers, retries                  │
│ • Observability, security                    │
└──────────────────────────────────────────────┘
```

### 4. Caching & Performance
```
┌──────────────────────────────────────────────┐
│ Redis                                        │
│ • String: SET key value / GET key            │
│ • Hash: HSET user:1 name "John"              │
│ • List: LPUSH queue task / RPOP queue        │
│ • Set: SADD tags "redis" "cache"             │
│ • Sorted Set: ZADD leaderboard 100 player    │
│                                              │
│ Use Cases:                                   │
│ • Session storage (SETEX session:id data)    │
│ • Rate limiting (INCR + EXPIRE)              │
│ • Leaderboards (Sorted Sets)                 │
│ • Caching (Cache-aside pattern)              │
│ • Message queue (LPUSH/RPOP)                 │
└──────────────────────────────────────────────┘
```

### 5. Databases
```
┌──────────────────────────────────────────────┐
│ PostgreSQL (Cloud SQL)                       │
│ • Relational, ACID transactions              │
│ • SELECT * FROM users WHERE age > 18         │
│ • Backups: Automated + point-in-time         │
│ • HA: Regional replication                   │
│                                              │
│ Elasticsearch                                │
│ • Full-text search engine                    │
│ • GET /products/_search { "query": {...} }   │
│ • Aggregations for analytics                 │
│ • Inverted index for fast search             │
└──────────────────────────────────────────────┘
```

### 6. Automation & Orchestration
```
┌──────────────────────────────────────────────┐
│ Airflow (Workflow)                           │
│ • DAG: Directed Acyclic Graph                │
│ • Tasks: PythonOperator, BashOperator        │
│ • Scheduling: @daily, @hourly                │
│ • XCom: Cross-task communication             │
│                                              │
│ Rundeck (Job Scheduler)                      │
│ • Jobs: Automated runbooks                   │
│ • Nodes: Remote execution                    │
│ • Workflows: Multi-step processes            │
│ • API: Trigger jobs programmatically         │
│                                              │
│ Puppet (Config Management)                   │
│ • Manifests: Declarative config              │
│ • Resources: package, file, service          │
│ • Modules: Reusable components               │
│ • Idempotent: Safe to run multiple times     │
└──────────────────────────────────────────────┘
```

### 7. Warehouse Systems
```
┌──────────────────────────────────────────────┐
│ WMS (Warehouse Management System)            │
│ • Business Logic Layer                       │
│ • Functions:                                 │
│   - Receiving & Putaway                      │
│   - Order Processing                         │
│   - Pick Wave Generation                     │
│   - Inventory Management                     │
│   - Shipping & Tracking                      │
│                                              │
│ WCS (Warehouse Control System)               │
│ • Real-Time Control Layer                    │
│ • Functions:                                 │
│   - Conveyor routing decisions               │
│   - Sorter management                        │
│   - AS/RS crane control                      │
│   - AGV/AMR dispatch                         │
│   - PLC communication                        │
│                                              │
│ Integration: WMS ↔ Middleware ↔ WCS          │
└──────────────────────────────────────────────┘
```

### 8. DevOps & CI/CD
```
┌──────────────────────────────────────────────┐
│ Git/GitLab                                   │
│ • Version control: commit, push, pull        │
│ • Branching: feature, develop, main          │
│ • Merge: git merge / pull requests           │
│ • GitLab CI: .gitlab-ci.yml pipelines        │
│                                              │
│ CI/CD Pipeline:                              │
│ 1. Build: docker build                       │
│ 2. Test: npm test / pytest                   │
│ 3. Push: docker push registry/image          │  
│ 4. Deploy: kubectl apply -f k8s/             │
└──────────────────────────────────────────────┘
```

### 9. Scripting & Automation
```
┌──────────────────────────────────────────────┐
│ Bash                                         │
│ • Loops: for i in {1..5}; do echo $i; done   │
│ • Conditionals: if [ condition ]; then       │
│ • Pipes: cat file | grep "pattern" | wc -l   │
│                                              │
│ PowerShell                                   │
│ • Objects: Get-Process | Where CPU -gt 10    │
│ • Remoting: Invoke-Command -ComputerName     │
│ • Cmdlets: Verb-Noun structure               │
│                                              │
│ Python                                       │
│ • Scripting: os, sys, subprocess             │
│ • APIs: requests, flask                      │
│ • Data: pandas, json                         │
└──────────────────────────────────────────────┘
```

### 10. Security
```
┌──────────────────────────────────────────────┐
│ Authentication                               │
│ • JWT: Stateless tokens                      │
│ • OAuth 2.0: Delegated authorization         │
│ • MFA: Multi-factor authentication           │
│                                              │
│ Encryption                                   │
│ • Symmetric: AES (same key)                  │
│ • Asymmetric: RSA (public/private keys)      │
│ • Hashing: bcrypt (passwords)                │
│                                              │
│ Web Security                                 │
│ • HTTPS/TLS: Encrypted transport             │
│ • CORS: Cross-origin policies                │
│ • Headers: CSP, X-Frame-Options              │
│                                              │
│ OWASP Top 10                                 │
│ 1. Broken Access Control                     │
│ 2. Cryptographic Failures                    │
│ 3. Injection (SQL, Command)                  │
│ 4. Insecure Design                           │
│ 5. Security Misconfiguration                 │
└──────────────────────────────────────────────┘
```

## 🔄 Data Flow Example: Order Processing

```
1. USER REQUEST
   └─> GraphQL/REST API: POST /api/orders
       Body: { items: [...], customer: {...} }

2. API GATEWAY
   └─> Authenticate (JWT)
   └─> Rate limit check
   └─> Route to Order Service

3. ORDER SERVICE
   └─> Validate order
   └─> Check inventory (call Inventory Service)
   └─> Save to PostgreSQL
   └─> Cache in Redis (order:123)
   └─> Publish event to RabbitMQ/Kafka

4. MESSAGE BROKER
   └─> Order.Created event
       ├─> WMS: Create pick tasks
       ├─> Notification: Send email
       └─> Analytics: Update dashboard

5. WMS PROCESSING
   └─> Generate pick wave
   └─> Assign to picker
   └─> Send to WCS when picked

6. WCS CONTROL
   └─> Route item on conveyor
   └─> Trigger sorter diversion
   └─> Track to destination chute
   └─> Notify WMS completion

7. SHIPMENT
   └─> WMS creates shipment
   └─> Generate label
   └─> Update order status
   └─> Trigger notification

8. RESPONSE
   └─> Return to user: { orderId, status, tracking }
```

## 🎯 Key Concepts by Category

### Performance
```
• Caching: Redis (sessions, objects)
• CDN: Static assets
• Load Balancing: Distribute traffic
• Horizontal Scaling: Add more instances
• Database Indexing: Fast queries
• Connection Pooling: Reuse connections
• Async Processing: Message queues
```

### Reliability
```
• Retry Logic: Exponential backoff
• Circuit Breakers: Prevent cascading failures
• Health Checks: /health endpoints
• Graceful Degradation: Fallback mechanisms
• Redundancy: Multiple instances
• Backups: Regular snapshots
• Monitoring: Prometheus, Grafana
```

### Security
```
• Authentication: Who are you?
• Authorization: What can you do?
• Encryption: At rest & in transit
• Input Validation: Sanitize all inputs
• Least Privilege: Minimum permissions
• Security Headers: CSP, HSTS
• Logging: Audit trails
```

### DevOps
```
• Infrastructure as Code: Terraform
• CI/CD: Automated pipelines
• Containerization: Docker
• Orchestration: Kubernetes
• Configuration Management: Puppet
• Version Control: Git
• Monitoring: Logs, metrics, traces
```

## 🚀 Quick Command Reference

### Docker
```bash
docker build -t app:latest .
docker run -d -p 8080:80 --name app app:latest
docker-compose up -d
docker logs -f container_name
```

### Kubernetes
```bash
kubectl get pods -n production
kubectl apply -f deployment.yaml
kubectl scale deployment app --replicas=5
kubectl logs -f pod-name
```

### Git
```bash
git clone repo_url
git checkout -b feature-branch
git add . && git commit -m "message"
git push origin feature-branch
```

### Redis
```bash
redis-cli
SET key value EX 3600
GET key
HSET user:1 name "John"
LPUSH queue task
```

### PostgreSQL
```bash
psql -U user -d database
SELECT * FROM users WHERE age > 18;
CREATE INDEX idx_email ON users(email);
```

### Linux
```bash
ps aux | grep process_name
df -h  # Disk usage
top    # Process monitor
journalctl -u service_name -f  # Logs
```

## 💡 Interview Preparation Priorities

### High Priority (Must Know)
1. **REST API**: HTTP methods, status codes, design
2. **Docker**: Containers, images, Dockerfile
3. **Kubernetes**: Pods, deployments, services
4. **Git**: Branching, merging, CI/CD
5. **Security**: Authentication, OWASP Top 10
6. **Linux**: Commands, scripting, processes
7. **Redis**: Caching patterns, data structures
8. **WMS/WCS**: Concepts, integration

### Medium Priority (Should Know)
1. **GraphQL**: Queries, mutations, resolvers
2. **Middleware**: Message brokers, API gateways
3. **PostgreSQL**: Queries, optimization
4. **Python**: Scripting, automation
5. **Airflow**: DAGs, scheduling
6. **Puppet**: Configuration management
7. **Elasticsearch**: Search, aggregations

### Lower Priority (Nice to Know)
1. **PowerShell**: Windows automation
2. **Rundeck**: Job scheduling
3. **Advanced Kubernetes**: StatefulSets, Operators
4. **Advanced Security**: Pen testing, forensics
